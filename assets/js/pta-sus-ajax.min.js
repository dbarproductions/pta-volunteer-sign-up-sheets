!function(t){"use strict";var a={init:function(){this.bindEvents(),this.handlePopState()},bindEvents:function(){var a=this;t(document).on("click",".pta-sus-ajax-container a.pta-sus-link:not(.clear-signup):not(.clear-signup-link)",function(n){var s=t(this),i=s.attr("href")||"";if(-1===i.indexOf("signup_id=")&&-1===i.indexOf("action=clear")){var e=s.closest(".pta-sus-ajax-container");n.preventDefault(),a.loadPage(i,!0,e)}}),t(document).on("submit",'.pta-sus-ajax-container form[name="pta_sus_signup_form"]',function(n){n.preventDefault();var s=t(this),i=s.closest(".pta-sus-ajax-container");a.submitSignupForm(s,i)})},loadPage:function(a,n,s){var i=this.getQueryParams(a),e=s.data("pta-sus-instance"),o="undefined"!=typeof pta_sus_instances&&pta_sus_instances[e]?pta_sus_instances[e]:{};s.css("opacity",.5);var c={action:"pta_sus_public_navigation",security:pta_sus_vars.nonce,atts:o,container_id:e};t.each(i,function(t,a){"signup_id"!==t&&"_wpnonce"!==t&&"action"!==t&&(c[t]=a)}),t.post(pta_sus_vars.ajaxurl,c,function(o){if(o.success){var c=t(o.data.html);s.html(c.html()),s.css("opacity",1),n&&window.history.pushState({containerId:e,params:i},"",a),t("html, body").animate({scrollTop:s.offset().top-100},500)}})},submitSignupForm:function(a,n){var s=a.serializeArray(),i=n.data("pta-sus-instance"),e="undefined"!=typeof pta_sus_instances&&pta_sus_instances[i]?pta_sus_instances[i]:{};n.css("opacity",.5);var o={action:"pta_sus_public_signup_submit",security:pta_sus_vars.nonce,atts:e,container_id:i};t.each(s,function(t,a){o[a.name]=a.value}),t.post(pta_sus_vars.ajaxurl,o,function(a){if(a.success){var s=t(a.data.html);n.html(s.html()),n.css("opacity",1),t("html, body").animate({scrollTop:n.offset().top-100},500)}})},handlePopState:function(){var a=this;t(window).on("popstate",function(n){var s=n.originalEvent.state;if(s&&s.containerId){var i=t('[data-pta-sus-instance="'+s.containerId+'"]');i.length&&a.loadPage(window.location.href,!1,i)}})},getQueryParams:function(t){var a={},n=document.createElement("a");n.href=t;var s=n.search.substring(1);if(!s)return a;for(var i=s.split("&"),e=0;e<i.length;e++){var o=i[e].split("=");o[0]&&(a[o[0]]=decodeURIComponent(o[1]||""))}return a}};t(document).ready(function(){a.init()})}(jQuery);